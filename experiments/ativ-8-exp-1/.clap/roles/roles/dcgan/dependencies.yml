---
- name: Dependencies
  hosts: all
  gather_facts: yes
  tasks:
  - name: Update packages
    become: yes
    apt:
      upgrade: yes
      update_cache: yes

  - name: Ensure dependencies
    become: yes
    package:
      name:
      - make
      - gcc
      - libgfortran5
      - sysstat
      - libibnetdisc-dev
      - openmpi-bin
      - libopenmpi-dev
      - libhdf5-openmpi-dev
      - gfortran
      - build-essential
      state: present

  - name: Ensure folder structure
    become: no
    file:
      path: "{{ ansible_env.HOME }}/.local/src/Distributed-DCGAN/cifar10"
      state: directory

  - name: Download CIFAR10 dataset
    become: no
    get_url:
      url: https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz
      dest: /tmp/cifar10.tar.gz

  - name: Extract CIFAR10 dataset
    become: no
    unarchive:
      src: /tmp/cifar10.tar.gz
      dest: "{{ ansible_env.HOME }}/.local/src/Distributed-DCGAN/cifar10"
      remote_src: yes
